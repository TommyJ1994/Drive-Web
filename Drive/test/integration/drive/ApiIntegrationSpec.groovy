package drive

import grails.test.spock.IntegrationSpec

class ApiIntegrationSpec extends IntegrationSpec {

	def setup() {
	}

	def cleanup() {
	}

	void testAddNewVehicleSuccess() {
		when: "We pass data to the addNewVehicle() method"

		def apiController = new ApiController()

		apiController.request.json = '{"dateOfBirth":{"year":2016,"month":2,"dayOfMonth":23},"gender":"male","country":"Australia","carData":{"make":{"id":200000001,"name":"Audi","niceName":"audi"},"model":{"id":"Audi_200","name":"200","niceName":"200"},"engine":{"id":"200654469","name":"Engine","equipmentType":"ENGINE","compressionRatio":9,"cylinder":5,"size":2.2,"configuration":"inline","fuelType":"regular unleaded","horsepower":217,"torque":228,"type":"gas","code":"5ITCG2.2","compressorType":"turbocharger","rpm":{"horsepower":5700,"torque":1950}},"transmission":{"id":"200654468","name":"5M","equipmentType":"TRANSMISSION","transmissionType":"MANUAL","numberOfSpeeds":"5"},"drivenWheels":"all wheel drive","numOfDoors":"4","options":[],"colors":[{"category":"Exterior","options":[{"id":"200654483","name":"Titanium Gray Metallic","equipmentType":"COLOR","manufactureOptionName":"Titanium Gray Metallic","manufactureOptionCode":"000"},{"id":"200654482","name":"Amarena Pearl Metallic","equipmentType":"COLOR","manufactureOptionName":"Amarena Pearl Metallic","manufactureOptionCode":"000"},{"id":"200654477","name":"Indigo Pearl Metallic","equipmentType":"COLOR","manufactureOptionName":"Indigo Pearl Metallic","manufactureOptionCode":"000"},{"id":"200654486","name":"Pearl White Metallic","equipmentType":"COLOR","manufactureOptionName":"Pearl White Metallic","manufactureOptionCode":"000"},{"id":"200654472","name":"Bamboo Metallic","equipmentType":"COLOR","manufactureOptionName":"Bamboo Metallic","manufactureOptionCode":"000"},{"id":"200654485","name":"Zycalm Red Pearl Metallic","equipmentType":"COLOR","manufactureOptionName":"Zycalm Red Pearl Metallic","manufactureOptionCode":"000"},{"id":"200654484","name":"Tornado Red","equipmentType":"COLOR","manufactureOptionName":"Tornado Red","manufactureOptionCode":"000"},{"id":"200654479","name":"Opal Pearl Metallic","equipmentType":"COLOR","manufactureOptionName":"Opal Pearl Metallic","manufactureOptionCode":"000"},{"id":"200654478","name":"Lago Blue Metallic","equipmentType":"COLOR","manufactureOptionName":"Lago Blue Metallic","manufactureOptionCode":"000"},{"id":"200654475","name":"Crystal Silver Metallic","equipmentType":"COLOR","manufactureOptionName":"Crystal Silver Metallic","manufactureOptionCode":"000"},{"id":"200654476","name":"Glacier Blue Metallic","equipmentType":"COLOR","manufactureOptionName":"Glacier Blue Metallic","manufactureOptionCode":"000"},{"id":"200654481","name":"Alpine White","equipmentType":"COLOR","manufactureOptionName":"Alpine White","manufactureOptionCode":"000"},{"id":"200654470","name":"Papyrus Metallic","equipmentType":"COLOR","manufactureOptionName":"Papyrus Metallic","manufactureOptionCode":"000"},{"id":"200654480","name":"Panther Black Metallic","equipmentType":"COLOR","manufactureOptionName":"Panther Black Metallic","manufactureOptionCode":"000"},{"id":"200654473","name":"Black","equipmentType":"COLOR","manufactureOptionName":"Black","manufactureOptionCode":"000"},{"id":"200654471","name":"Aquamarine Metallic","equipmentType":"COLOR","manufactureOptionName":"Aquamarine Metallic","manufactureOptionCode":"000"},{"id":"200654474","name":"Cayenne Pearl Metallic","equipmentType":"COLOR","manufactureOptionName":"Cayenne Pearl Metallic","manufactureOptionCode":"000"}]}],"price":{"usedTmvRetail":2000,"usedPrivateParty":1063,"usedTradeIn":500,"estimateTmv":false},"categories":{"market":"Luxury,Performance","EPAClass":"MIDSIZE_CARS","vehicleSize":"Midsize","primaryBodyType":"Car","vehicleStyle":"Sedan","vehicleType":"Car"},"id":17824,"name":"quattro Turbo 4dr Sedan AWD","year":{"id":3301,"year":1991},"submodel":{"body":"Sedan","modelName":"200 Sedan","niceName":"sedan"},"trim":"quattro","states":["USED"],"squishVins":["WAUGE544MN"],"MPG":{"highway":"22","city":"16"},"$$hashKey":"object:1891"}}'

		apiController.addNewVehicle()

		then: "Then a new driver, vehicle and overallStatistics should be created"
		Driver.list().size() == 1
		Vehicle.list().size() == 1
		OverallStatistics.list().size() == 1
	}

	void testAddNewVehicleFailure() {
		when: "We pass data to the addNewVehicle() method"

		def apiController = new ApiController()

		apiController.request.json = '{"dateOfBirth":{"year":1994,"month":2,"dayOfMonth":13},"gender":"female","country":"Ireland","carData":{"make":{"id":200000001,"name":"Audi","niceName":"audi"},"model":{"id":"Audi_200","name":"200","niceName":"200"},"engine":{"id":"200654469","name":"Engine","equipmentType":"ENGINE","compressionRatio":9,"cylinder":5,"size":2.2,"configuration":"inline","fuelType":"regular unleaded","horsepower":217,"torque":228,"type":"gas","code":"5ITCG2.2","compressorType":"turbocharger","rpm":{"horsepower":5700,"torque":1950}},"transmission":{"id":"200654468","name":"5M","equipmentType":"TRANSMISSION","transmissionType":"MANUAL","numberOfSpeeds":"5"},"drivenWheels":"all wheel drive","numOfDoors":"4","options":[],"colors":[{"category":"Exterior","options":[{"id":"200654483","name":"Titanium Gray Metallic","equipmentType":"COLOR","manufactureOptionName":"Titanium Gray Metallic","manufactureOptionCode":"000"},{"id":"200654482","name":"Amarena Pearl Metallic","equipmentType":"COLOR","manufactureOptionName":"Amarena Pearl Metallic","manufactureOptionCode":"000"},{"id":"200654477","name":"Indigo Pearl Metallic","equipmentType":"COLOR","manufactureOptionName":"Indigo Pearl Metallic","manufactureOptionCode":"000"},{"id":"200654486","name":"Pearl White Metallic","equipmentType":"COLOR","manufactureOptionName":"Pearl White Metallic","manufactureOptionCode":"000"},{"id":"200654472","name":"Bamboo Metallic","equipmentType":"COLOR","manufactureOptionName":"Bamboo Metallic","manufactureOptionCode":"000"},{"id":"200654485","name":"Zycalm Red Pearl Metallic","equipmentType":"COLOR","manufactureOptionName":"Zycalm Red Pearl Metallic","manufactureOptionCode":"000"},{"id":"200654484","name":"Tornado Red","equipmentType":"COLOR","manufactureOptionName":"Tornado Red","manufactureOptionCode":"000"},{"id":"200654479","name":"Opal Pearl Metallic","equipmentType":"COLOR","manufactureOptionName":"Opal Pearl Metallic","manufactureOptionCode":"000"},{"id":"200654478","name":"Lago Blue Metallic","equipmentType":"COLOR","manufactureOptionName":"Lago Blue Metallic","manufactureOptionCode":"000"},{"id":"200654475","name":"Crystal Silver Metallic","equipmentType":"COLOR","manufactureOptionName":"Crystal Silver Metallic","manufactureOptionCode":"000"},{"id":"200654476","name":"Glacier Blue Metallic","equipmentType":"COLOR","manufactureOptionName":"Glacier Blue Metallic","manufactureOptionCode":"000"},{"id":"200654481","name":"Alpine White","equipmentType":"COLOR","manufactureOptionName":"Alpine White","manufactureOptionCode":"000"},{"id":"200654470","name":"Papyrus Metallic","equipmentType":"COLOR","manufactureOptionName":"Papyrus Metallic","manufactureOptionCode":"000"},{"id":"200654480","name":"Panther Black Metallic","equipmentType":"COLOR","manufactureOptionName":"Panther Black Metallic","manufactureOptionCode":"000"},{"id":"200654473","name":"Black","equipmentType":"COLOR","manufactureOptionName":"Black","manufactureOptionCode":"000"},{"id":"200654471","name":"Aquamarine Metallic","equipmentType":"COLOR","manufactureOptionName":"Aquamarine Metallic","manufactureOptionCode":"000"},{"id":"200654474","name":"Cayenne Pearl Metallic","equipmentType":"COLOR","manufactureOptionName":"Cayenne Pearl Metallic","manufactureOptionCode":"000"}]}],"price":{"usedTmvRetail":2000,"usedPrivateParty":1063,"usedTradeIn":500,"estimateTmv":false},"categories":{"market":"Luxury,Performance","EPAClass":"MIDSIZE_CARS","vehicleSize":"Midsize","primaryBodyType":"Car","vehicleStyle":"Sedan","vehicleType":"Car"},"id":17824,"name":"quattro Turbo 4dr Sedan AWD","year":{"id":3301,"year":1991},"submodel":{"body":"Sedan","modelName":"200 Sedan","niceName":"sedan"},"trim":"quattro","states":["USED"],"squishVins":["WAUGE544MN"],"MPG":{"highway":"22","city":"16"},"$$hashKey":"object:1891"}}'

		apiController.addNewVehicle()

		then: "Then a new driver, vehicle and overallStatistics should be created"
		Driver.list().size() == 0
		Vehicle.list().size() == 0
		OverallStatistics.list().size() == 0
	}

	void testAddNewVehicleFailure2() {
		when: "We pass data to the addNewVehicle() method"

		def apiController = new ApiController()

		apiController.request.json = '{"dateOfBirth":{"year":1967,"month":3,"dayOfMonth":22},"gender":"male","country":"Germany","carData":{"make":{"id":200000001,"name":"Audi","niceName":"audi"},"model":{"id":"Audi_200","name":"200","niceName":"200"},"engine":{"id":"200654469","name":"Engine","equipmentType":"ENGINE","compressionRatio":9,"cylinder":5,"size":2.2,"configuration":"inline","fuelType":"regular unleaded","horsepower":217,"torque":228,"type":"gas","code":"5ITCG2.2","compressorType":"turbocharger","rpm":{"horsepower":5700,"torque":1950}},"transmission":{"id":"200654468","name":"5M","equipmentType":"TRANSMISSION","transmissionType":"MANUAL","numberOfSpeeds":"5"},"drivenWheels":"all wheel drive","numOfDoors":"4","options":[],"colors":[{"category":"Exterior","options":[{"id":"200654483","name":"Titanium Gray Metallic","equipmentType":"COLOR","manufactureOptionName":"Titanium Gray Metallic","manufactureOptionCode":"000"},{"id":"200654482","name":"Amarena Pearl Metallic","equipmentType":"COLOR","manufactureOptionName":"Amarena Pearl Metallic","manufactureOptionCode":"000"},{"id":"200654477","name":"Indigo Pearl Metallic","equipmentType":"COLOR","manufactureOptionName":"Indigo Pearl Metallic","manufactureOptionCode":"000"},{"id":"200654486","name":"Pearl White Metallic","equipmentType":"COLOR","manufactureOptionName":"Pearl White Metallic","manufactureOptionCode":"000"},{"id":"200654472","name":"Bamboo Metallic","equipmentType":"COLOR","manufactureOptionName":"Bamboo Metallic","manufactureOptionCode":"000"},{"id":"200654485","name":"Zycalm Red Pearl Metallic","equipmentType":"COLOR","manufactureOptionName":"Zycalm Red Pearl Metallic","manufactureOptionCode":"000"},{"id":"200654484","name":"Tornado Red","equipmentType":"COLOR","manufactureOptionName":"Tornado Red","manufactureOptionCode":"000"},{"id":"200654479","name":"Opal Pearl Metallic","equipmentType":"COLOR","manufactureOptionName":"Opal Pearl Metallic","manufactureOptionCode":"000"},{"id":"200654478","name":"Lago Blue Metallic","equipmentType":"COLOR","manufactureOptionName":"Lago Blue Metallic","manufactureOptionCode":"000"},{"id":"200654475","name":"Crystal Silver Metallic","equipmentType":"COLOR","manufactureOptionName":"Crystal Silver Metallic","manufactureOptionCode":"000"},{"id":"200654476","name":"Glacier Blue Metallic","equipmentType":"COLOR","manufactureOptionName":"Glacier Blue Metallic","manufactureOptionCode":"000"},{"id":"200654481","name":"Alpine White","equipmentType":"COLOR","manufactureOptionName":"Alpine White","manufactureOptionCode":"000"},{"id":"200654470","name":"Papyrus Metallic","equipmentType":"COLOR","manufactureOptionName":"Papyrus Metallic","manufactureOptionCode":"000"},{"id":"200654480","name":"Panther Black Metallic","equipmentType":"COLOR","manufactureOptionName":"Panther Black Metallic","manufactureOptionCode":"000"},{"id":"200654473","name":"Black","equipmentType":"COLOR","manufactureOptionName":"Black","manufactureOptionCode":"000"},{"id":"200654471","name":"Aquamarine Metallic","equipmentType":"COLOR","manufactureOptionName":"Aquamarine Metallic","manufactureOptionCode":"000"},{"id":"200654474","name":"Cayenne Pearl Metallic","equipmentType":"COLOR","manufactureOptionName":"Cayenne Pearl Metallic","manufactureOptionCode":"000"}]}],"price":{"usedTmvRetail":2000,"usedPrivateParty":1063,"usedTradeIn":500,"estimateTmv":false},"categories":{"market":"Luxury,Performance","EPAClass":"MIDSIZE_CARS","vehicleSize":"Midsize","primaryBodyType":"Car","vehicleStyle":"Sedan","vehicleType":"Car"},"id":17824,"name":"quattro Turbo 4dr Sedan AWD","year":{"id":3301,"year":1991},"submodel":{"body":"Sedan","modelName":"200 Sedan","niceName":"sedan"},"trim":"quattro","states":["USED"],"squishVins":["WAUGE544MN"],"MPG":{"highway":"22","city":"16"},"$$hashKey":"object:1891"}}'

		apiController.addNewVehicle()

		then: "Then a new driver, vehicle and overallStatistics should be created"
		Driver.list().size() == 0
		Vehicle.list().size() == 0
		OverallStatistics.list().size() == 0
	}
}
